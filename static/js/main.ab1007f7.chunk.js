(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[0],{101:function(e,t,n){},164:function(e,t,n){e.exports=n(351)},169:function(e,t,n){},351:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(32),r=n.n(o),l=(n(169),n(98)),s=(n(101),n(18)),c=n(12),u=n(19),p=n(20),m=n(21),d=n(160),h=n(51),g=n(102),f=n(105),b=n(103),y=n(104),v=n(156),k=n.n(v),E=n(71),C={submit:"http://18.218.210.185:1330/submit",view:"http://18.218.210.185:1330/view",count:"http://18.218.210.185:1330/count",type:"real"},S=n(72),L=n.n(S),w={getCount:function(e,t){return L.a.post(C.count,{latlng1:e,latlng2:t},{headers:{"Content-Type":"application/json"}})},view:function(e,t,n,a){return L.a.post(C.view,{latlng1:e,latlng2:t,skip:n,pagelimit:a},{headers:{"Content-Type":"application/json"}})},submit:function(e,t,n){var a=new FormData;return a.append("text",e),a.append("lat",t[0]),a.append("lng",t[1]),a.append("timestamp",(new Date).toGMTString()),null===n?a.append("file",null):a.append("file",n),L.a.post(C.submit,a,{headers:{"Content-Type":"multipart/form-data"}})}},x=n(189),j="mock"===C.type?{getCount:function(e,t){return new Promise((function(e,t){e({data:{count:100}})}))},view:function(e,t,n,a){for(var i=[],o=["Hey, I'm at Rice! Please look at my story.","What's up guys?  Places.io is so cool!  Good job COMP 413 Blue Team.","Check out my story guys please be careful !!","Rice University is a comprehensive research university located on a 300-acre tree-lined campus in Houston, Texas. Rice produces the next generation of leaders and advances tomorrow\u2019s thinking."],r=["https://cdn.shopify.com/s/files/1/3004/1474/products/orange-tabby_1800x1800.png?v=1544042837","https://images.pexels.com/photos/1108099/pexels-photo-1108099.jpeg?cs=srgb&dl=adorable-animal-breed-1108099.jpg&fm=jpg","https://avatars1.githubusercontent.com/u/23466848?s=400&v=4","https://tribkswb.files.wordpress.com/2018/09/s098916860.jpg?quality=85&strip=all&w=1540",null,null,null],l=0;l<100;l++){var s=o[x.random(0,o.length-1)],c=r[x.random(0,r.length-1)];i.push({storyid:l,lat:x.random(e[0],t[0],!0),long:x.random(e[1],t[1],!0),image_url:c,text:s,timestamp:(new Date).toGMTString()})}return new Promise((function(e,t){e({data:{entries:i.slice(n,Math.min(i.length,n+a))}})}))},submit:function(e,t,n){return new Promise((function(e,t){e({status:"Mock submit success"})}))}}:w,N={getCount:function(e,t){return j.getCount(e,t)},view:function(e,t,n,a){return j.view(e,t,n,a)},submit:function(e,t,n){return j.submit(e,t,n)}},O=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).map=void 0,n.state={currentZoom:10},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.map.leafletElement.on("zoomend",(function(){e.setState({currentZoom:e.map.leafletElement.getZoom()})}))}},{key:"handleClick",value:function(e){this.props.updateLatLngFunc({lat:e.latlng.wrap().lat,lng:e.latlng.wrap().lng})}},{key:"handleViewClick",value:function(){var e=this,t=this.map.leafletElement.getBounds().getSouthWest().wrap(),n=this.map.leafletElement.getBounds().getNorthEast().wrap(),a=[n.lat,t.lng].map((function(e){return Number(e)})),i=[t.lat,n.lng].map((function(e){return Number(e)}));N.view(a,i,0,10).then((function(t){e.props.updateCurrentDataPoints(t.data.entries),e.props.updateBoundingBox(a,i)})).catch((function(e){return console.log(e)}))}},{key:"mapCenter",value:function(){return[29.749907,-95.358421]}},{key:"render",value:function(){var e=this;return i.a.createElement(g.a,{ref:function(t){e.map=t},onClick:this.handleClick.bind(this),center:this.mapCenter(),zoom:10,style:{height:"90vh",width:"100%"}},i.a.createElement(f.a,{attribution:'&copy <a href="https://github.com/rice-comp413-blue/places.io">BlueTeam</a> | places.io',url:"https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png"}),this.props.markers.filter((function(t){return t.storyid!==e.props.selectedStory})).map((function(t){return i.a.createElement(b.a,{key:t.storyid,position:[t.lat,t.long],onClick:function(){return e.props.onStoryClick(t.storyid)}},i.a.createElement(y.a,null,i.a.createElement("h5",null,"Description"),i.a.createElement("br",null)," ",t.text,t.image_url?i.a.createElement("img",{alt:"Story",src:t.image_url,style:{height:"100px"}}):i.a.createElement("p",{className:"missing"},"No image attached."),i.a.createElement("p",null,"Story Id: ",t.storyid)))})),this.props.markers.filter((function(t){return t.storyid===e.props.selectedStory})).map((function(e){return i.a.createElement(D,{key:e.storyid,position:[e.lat,e.long]},i.a.createElement(y.a,null,i.a.createElement("div",null,e.text," "),i.a.createElement("br",null),e.image_url?i.a.createElement("img",{alt:"Story",src:e.image_url,style:{height:"100px"}}):i.a.createElement("p",{className:"missing"},"No image attached."),i.a.createElement("p",null,"Story Id: ",e.storyid)))})),"view"===this.props.mode&&this.state.currentZoom>6?i.a.createElement(k.a,{position:"topright"},i.a.createElement(E.a,{onClick:this.handleViewClick.bind(this)},"Query")):null)}}]),t}(i.a.Component),D=function(e){return i.a.createElement(b.a,Object.assign({ref:function(e){e&&e.leafletElement.openPopup()}},e))},B=O,F=n(4),P=n(369),R=n(375),M=n(371),T=n(372),I=n(373),_=n(374),z=n(74),U=Object(P.a)((function(){return{card:{maxWidth:1e3,borderStyle:"solid",borderWidth:"0.5px",boxShadow:"3px 3px 5px grey",borderColor:"grey",marginBottom:"1em",cursor:"pointer"},media:{height:0,paddingTop:"56.25%"},headerTitle:{fontSize:"0.65em"},subHeader:{fontSize:"0.85em"},text:{color:"black"},id:{fontSize:"0.6em",right:0,fontStyle:"italic",marginLeft:"auto",marginRight:0,color:"grey"}}}));function W(e){var t=U();return i.a.createElement(R.a,{className:t.card,style:e.selected?{borderWidth:"5px"}:void 0,onClick:function(){return e.onStoryClick(e.story.storyid)}},i.a.createElement(M.a,{title:i.a.createElement("div",{className:t.headerTitle},"Location: (".concat(e.story.lat.toFixed(4),", ").concat(e.story.long.toFixed(4),")")),subheader:i.a.createElement("div",{className:t.subHeader},new Date(e.story.timestamp).toLocaleString("en-US"))}),e.story.image_url?i.a.createElement(T.a,{className:t.media,image:e.story.image_url,title:"Story Image"}):null,i.a.createElement(I.a,null,i.a.createElement(z.a,{variant:"body2",color:"textSecondary",component:"div"},i.a.createElement("div",{className:t.text},e.story.text))),i.a.createElement(_.a,null,i.a.createElement("div",{className:t.id},"Story ID: ".concat(e.story.storyid))))}var V=function(e){return i.a.createElement("p",{className:"missing"},"Empty feed \u2014 make a view request!")},G=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).myRef=i.a.createRef(),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){this.myRef.current&&this.myRef.current.scrollIntoView({behavior:"smooth",block:"start"})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:this.props.className},this.props.elements.length>0?this.props.elements.map((function(t){return i.a.createElement("div",{key:t.storyid,ref:t.storyid===e.props.selectedStory?e.myRef:i.a.createRef()},i.a.createElement(W,{story:t,onStoryClick:e.props.onStoryClick,selected:t.storyid===e.props.selectedStory}))})):i.a.createElement(V,null))}}]),t}(i.a.Component),H=n(73),Z=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).state={description:"",file:null},n.fileUpload=null,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleFileSelection",value:function(e){this.setState({file:e.target.files[0]})}},{key:"handleSubmit",value:function(e){N.submit(this.state.description,this.props.curLatLng,this.state.file).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)})),this.setState({description:"",file:null}),this.props.updateLatLngFunc({lat:0,lng:0}),this.fileUpload.value=""}},{key:"updateDescription",value:function(e){this.setState({description:e.target.value})}},{key:"buttonEnabled",value:function(){var e=null!==this.props.curLatLng[0]&&null!=this.props.curLatLng[1],t=""!==this.state.description,n=null!==this.state.file;return e&&(t||n)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("div",null,"Selected point: (",this.props.curLatLng[0].toFixed(4)," ",this.props.curLatLng[1].toFixed(4),")"),i.a.createElement(H.a,null,i.a.createElement(H.a.Group,null,i.a.createElement(H.a.Control,{value:this.state.description,onChange:this.updateDescription.bind(this),type:"text",placeholder:"Enter a description"})),i.a.createElement("div",null,i.a.createElement("input",{type:"file",accept:"image/*",id:"fileinput",onChange:this.handleFileSelection.bind(this),ref:function(t){return e.fileUpload=t}})),i.a.createElement("br",null),i.a.createElement(E.a,{disabled:!this.buttonEnabled(),variant:"primary",onClick:this.handleSubmit.bind(this),title:"Select a point on the map first."},"Submit")))}}]),t}(i.a.Component),q=n(158),A=n(159),J=n.n(A),Q=10,$=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).handlePageClick=function(e){N.view(n.props.upperLeft,n.props.bottomRight,e.selected*Q,Q).then((function(e){n.props.updateCurrentDataPoints(e.data.entries)})).catch((function(e){return console.log(e)})),n.setState({pageNum:e.selected})},n.updateMode=function(e){return n.props.updateModeFunc(e)},n.render=function(){return i.a.createElement("div",{className:"sidebar"},i.a.createElement(q.SegmentedControl,{name:"modeToggle",options:[{label:"View",value:"view",default:!0},{label:"Submit",value:"submit"}],setValue:function(e){return n.updateMode(e)},style:{width:"100%",height:"3em",fontSize:"0.9em",textAlign:"center",color:"#2980b9"}}),"view"===n.props.mode?i.a.createElement(G,{className:"feed",elements:n.props.feed,onStoryClick:n.props.onStoryClick,selectedStory:n.props.selectedStory}):i.a.createElement(Z,{updateLatLngFunc:n.props.updateLatLngFunc.bind(Object(F.a)(n)),curLatLng:n.props.curLatLng}),"view"===n.props.mode&&n.state.pageCount&&n.props.feed.length>0?i.a.createElement("div",{className:"paginate-container"},i.a.createElement(J.a,{forcePage:n.state.pageNum,previousLabel:"previous",nextLabel:"next",breakLabel:"...",pageCount:n.state.pageCount,marginPagesDisplayed:1,pageRangeDisplayed:1,onPageChange:n.handlePageClick.bind(Object(F.a)(n)),containerClassName:"pagination",subContainerClassName:"pages pagination",activeClassName:"active",breakClassName:"page-item",breakLinkClassName:"page-link",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link"})):null)},n.state={pageCount:null,pageNum:0},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=e.upperLeft,a=this.props.upperLeft,i=e.bottomRight,o=this.props.bottomRight;(n.length!==a.length||i.length!==o.length||n[0]!==a[0]||n[1]!==a[1]||i[0]!==o[0]||i[1]!==o[1])&&(N.getCount(a,o).then((function(e){t.setState({pageCount:Math.ceil(e.data.count/Q)})})).catch((function(e){return console.log(e)})),this.setState({pageNum:0}))}}]),t}(i.a.Component),K=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).state={mode:"view",curLatLng:{lat:0,lng:0},currentData:[],boundingBox:{upperLeft:[],bottomRight:[]},selectedStoryId:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"updateModeFunc",value:function(e){this.setState({mode:e})}},{key:"updateLatLngFunc",value:function(e){this.setState({curLatLng:e})}},{key:"updateCurrentDataPoints",value:function(e){this.setState({currentData:e})}},{key:"updateBoundingBox",value:function(e,t){this.setState({boundingBox:{upperLeft:e,bottomRight:t}})}},{key:"onStoryClick",value:function(e){this.setState({selectedStoryId:e})}},{key:"render",value:function(){var e=[this.state.curLatLng.lat,this.state.curLatLng.lng];return i.a.createElement(d.a,null,i.a.createElement(h.a,{md:3},i.a.createElement($,{curLatLng:e,mode:this.state.mode,updateLatLngFunc:this.updateLatLngFunc.bind(this),updateModeFunc:this.updateModeFunc.bind(this),updateCurrentDataPoints:this.updateCurrentDataPoints.bind(this),feed:this.state.currentData,upperLeft:this.state.boundingBox.upperLeft,bottomRight:this.state.boundingBox.bottomRight,onStoryClick:this.onStoryClick.bind(this),selectedStory:this.state.selectedStoryId})),i.a.createElement(h.a,{md:9},i.a.createElement(B,{mode:this.state.mode,updateLatLngFunc:this.updateLatLngFunc.bind(this),updateCurrentDataPoints:this.updateCurrentDataPoints.bind(this),updateBoundingBox:this.updateBoundingBox.bind(this),markers:this.state.currentData,onStoryClick:this.onStoryClick.bind(this),selectedStory:this.state.selectedStoryId})))}}]),t}(i.a.Component);var X=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(l.a,{bg:"light"},i.a.createElement(l.a.Brand,null,"places.io")),i.a.createElement(K,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[164,1,2]]]);
//# sourceMappingURL=main.ab1007f7.chunk.js.map